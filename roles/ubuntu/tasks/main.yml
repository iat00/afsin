---
- name: ansible repo
  apt_repository: repo=ppa:rquillo/ansible

- name: install apt packages
  apt: name={{ item }} state=installed
  with_items:
    - emacs24-nox
    - facter
    - htop
    - lynx
    - nmap
    - python-keyczar
    - python-zmq
    - python-pycurl
    - sshpass
    - tmux
    - traceroute
    - yaml-mode
    - zsh
    - unzip
    - psmisc
    - vim
    - mc

- name: disable ipv6
  copy: src={{ item }} dest=/{{ item }}
  with_items:
    - etc/sysctl.d/disable-ipv6.conf

- name: set timezone
  copy: src={{ item }} dest=/{{ item }}
  with_items:
    - etc/timezone
  notify:
    - update timezone

- name: set dns search string
  lineinfile: dest=/etc/network/interfaces regexp='^[     ]*dns-search.*' line='        dns-search toparlak.de'
  notify: 
    - restart networking

#- name: customize /etc/fail2ban/jail.conf
#  lineinfile: dest=/etc/fail2ban/jail.conf regexp='^bantime  = 600' line='bantime = 3600' backrefs=yes
#  notify:
#    - restart fail2ban

#- name: customize /etc/fail2ban/jail.conf
#  lineinfile: dest=/etc/fail2ban/jail.conf regexp='^findtime = 600' line='findtime = 3600' backrefs=yes
#  notify:
#    - restart fail2ban

- apt: name=munin-node state=installed
- copy: src=etc/munin/munin-node.conf dest=/etc/munin/munin-node.conf
